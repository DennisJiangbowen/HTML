<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FBX模型文件和动画加载</title>
    <!--引入three.js三维引擎-->
    <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/build/three.js"></script>
    <!-- 引入threejs扩展控件OrbitControls.js -->
    <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/examples/js/controls/OrbitControls.js"></script>
    <!-- 引入fbx模型加载库FBXLoader -->
    <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/examples/js/loaders/FBXLoader.js"></script>
    <!-- 辅助文件 -->
    <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/examples/js/libs/inflate.min.js"></script>

</head>
<body>
    <button onclick="puash()">点击</button>
    <script>
        var animation;
        var clip;
        function puash(){
            // 开始结束时间设置为一样，相当于播放时间为0，直接跳转到时间点对应的状态
            animation.time += 0.1; //操作对象设置开始播放时间
            clip.duration = animation.time;//剪辑对象设置播放结束时间
            animation.play(); //开始播放
        }
        var mix = null;//声明一个混合器变量
        var scene = new THREE.Scene();
        var loader = new THREE.FBXLoader().load('./所需文件/人物跳舞模型+动画/SambaDancing.fbx',function(obj){
            mix = new THREE.AnimationMixer(obj);// obj作为参数创建一个混合器，解析播放obj及其子对象包含的动画数据
            animation = mix.clipAction(obj.animations[0]);// obj.animations[0]：获得剪辑对象clip
            clip = obj.animations[0];
            console.log(obj);
            // animation.timeScale = 1; //默认1，可以调节播放速度
            animation.loop = THREE.LoopOnce; //不循环播放
            animation.clampWhenFinished=true;//暂停在最后一帧播放的状态
            // animation.play();//播放动画
            obj.translateY(-80);
            scene.add(obj);
        });
        var light = new THREE.PointLight(0xffffff);
        light.position.set(200,100,300);
        scene.add(light);

        var height = window.innerHeight;
        var width = window.innerWidth;
        var k = width / height;
        var s =150;
        var camera = new THREE.OrthographicCamera(-s*k, s*k, s, -s, 1, 1000);
        camera.position.set(200, 300, 200);
        camera.lookAt(scene.position);

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(width, height);
        renderer.setClearColor(0xb9d3ff, 1);
        document.body.appendChild(renderer.domElement);

        var clock = new THREE.Clock();
        function render(){
            renderer.render(scene, camera);
            requestAnimationFrame(render);
            if(mix !== null){
                mix.update(clock.getDelta());
            }
        }
        render();

        var contorl = new THREE.OrbitControls(camera, renderer.domElement);

    </script>
</body>
</html>